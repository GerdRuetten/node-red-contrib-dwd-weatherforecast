<script type="text/x-red" data-help-name="dwd-weatherforecast">
    <p>
        Ruft die offizielle DWD MOSMIX_L-Vorhersage für eine einzelne Messstation ab
        und stellt sie als Zeitreihe für weitere Flows (Dashboards, Auswertungen, Automationen) bereit.
    </p>

    <h3>Eingaben</h3>
    <dl class="message-properties">
        <dt>msg.payload
            <span class="property-type">beliebig</span>
        </dt>
        <dd>
            Der Inhalt der eingehenden Nachricht wird vom Node nicht ausgewertet.
            Jeder eingehende Trigger löst – sofern konfiguriert – einen neuen Abruf aus.
        </dd>
    </dl>

    <h3>Ausgaben</h3>
    <dl class="message-properties">
        <dt>msg.payload
            <span class="property-type">Array&lt;Object&gt;</span>
        </dt>
        <dd>
            Array von Vorhersagepunkten in zeitlicher Reihenfolge.
            Jeder Eintrag enthält mindestens Zeitstempel (<code>ts</code>, <code>iso</code>),
            Temperatur, Wind, Luftfeuchte, Luftdruck, Sichtweite,
            Bewölkung und Niederschlag (<code>precipitation</code>,
            <code>precipitationText</code>).
            Weitere Felder können je nach Konfiguration hinzukommen.
        </dd>

        <dt>msg.stationId
            <span class="property-type">string</span>
        </dt>
        <dd>
            Die verwendete DWD-Stations-ID.
        </dd>

        <dt>msg.meta
            <span class="property-type">Object</span>
        </dt>
        <dd>
            Metadaten zur Abfrage (Zeitpunkt, Quelle, ggf. Diagnose-Informationen).
        </dd>
    </dl>

    <h3>Konfiguration</h3>
    <dl>
        <dt>DWD-Stations-ID</dt>
        <dd>
            Offizielle DWD-Kennung der Messstation (z.&nbsp;B. <code>H721</code> für Köln/Bonn).
            Wird dieses Feld leer gelassen, schlägt der Node mit einem Fehlerstatus fehl.
        </dd>

        <dt>Quell-URL</dt>
        <dd>
            URL-Template für die MOSMIX_L-KMZ-Datei.
            Standardmäßig wird die offizielle DWD-Open-Data-URL verwendet.
        </dd>

        <dt>Beim Deploy abrufen</dt>
        <dd>
            Löst direkt nach dem Deploy einen Abruf aus, damit sofort Daten zur Verfügung stehen.
        </dd>

        <dt>Auto-Refresh</dt>
        <dd>
            Optionales Intervall (Sekunden) für wiederkehrende Abrufe,
            ohne dass ein separater Inject-Node benötigt wird.
        </dd>

        <dt>Vorlauf / Nur zukünftige Zeitpunkte</dt>
        <dd>
            Beschränkt den Vorhersagezeitraum und filtert auf zukünftige Zeitstempel,
            um historische MOSMIX-Daten auszublenden.
        </dd>

        <dt>Ausgabe-Optionen</dt>
        <dd>
            Steuern, ob nur Kernfelder (Minimal-Subset)
            oder zusätzliche Komfortfelder (z.&nbsp;B. Windrichtung als Himmelsrichtung,
            umgerechnete Einheiten) ausgegeben werden.
        </dd>
    </dl>

    <h3>Hinweise</h3>
    <ul>
        <li>Die Daten stammen aus der DWD MOSMIX_L-Vorhersage und werden typischerweise stündlich aktualisiert.</li>
        <li>Bei aktivierter Stale-Option bleibt bei Fehlern die letzte erfolgreiche Vorhersage im Kontext erhalten.</li>
        <li>Mit der Option „Windrichtungsmodus“ kann zusätzlich <code>windDirCardinal</code> ausgegeben werden.</li>
    </ul>
</script>
